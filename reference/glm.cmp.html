<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a Mean Parametrized Conway-Maxwell Poisson Generalized Linear Model — glm.cmp • mpcmp</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit a Mean Parametrized Conway-Maxwell Poisson Generalized Linear Model — glm.cmp" />
<meta property="og:description" content="The function glm.cmp is used to fit a mean parametrized Conway-Maxwell Poisson
generalized linear model with a log-link by using Fisher Scoring iteration." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mpcmp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/mpcmp.html">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thomas-fung/mpcmp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/people.html">
    <span class="fa fa-info-circle fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Mean Parametrized Conway-Maxwell Poisson Generalized Linear Model</h1>
    <small class="dont-index">Source: <a href='https://github.com/thomas-fung/mpcmp/blob/master/R/glm.cmp.R'><code>R/glm.cmp.R</code></a></small>
    <div class="hidden name"><code>glm.cmp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>glm.cmp</code> is used to fit a mean parametrized Conway-Maxwell Poisson
generalized linear model with a log-link by using Fisher Scoring iteration.</p>
    </div>

    <pre class="usage"><span class='fu'>glm.cmp</span>(
  <span class='kw'>formula</span>,
  formula_nu = <span class='kw'>NULL</span>,
  <span class='kw'>data</span>,
  offset = <span class='kw'>NULL</span>,
  <span class='kw'>subset</span>,
  <span class='kw'>na.action</span>,
  betastart = <span class='kw'>NULL</span>,
  gammastart = <span class='kw'>NULL</span>,
  lambdalb = <span class='fl'>1e-10</span>,
  lambdaub = <span class='fl'>1000</span>,
  maxlambdaiter = <span class='fl'>1000</span>,
  tol = <span class='fl'>1e-06</span>,
  contrasts_mu = <span class='kw'>NULL</span>,
  contrasts_nu = <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>an object of class 'formula': a symbolic description of the model to be fitted to the mean via log-link.</p></td>
    </tr>
    <tr>
      <th>formula_nu</th>
      <td><p>an optional object of class 'formula': a symbolic description of the model to be fitted to the dispersion via log-link.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>this can be used to specify an *a priori* known component to be included
in the linear predictor for mean during fitting. This should be <code>NULL</code> or a numeric vector
of length equal to the number of cases.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>an optional vector specifying a subset of observations to be used in the
fitting process.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function which indicates what should happen when the data contain
NAs. The default is set by the na.action setting of options, and is na.fail if that
is unset. The ‘factory-fresh’ default is na.omit. Another possible value is NULL,
no action. Value na.exclude can be useful.</p></td>
    </tr>
    <tr>
      <th>betastart</th>
      <td><p>starting values for the parameters in the linear predictor for mu.</p></td>
    </tr>
    <tr>
      <th>gammastart</th>
      <td><p>starting values for the parameters in the linear predictor for nu.</p></td>
    </tr>
    <tr>
      <th>lambdalb, lambdaub</th>
      <td><p>numeric: the lower and upper end points for the interval to be
searched for lambda(s). The default value for lambdaub should be sufficient for small to
moderate size nu. If nu is large and required a larger <code>lambdaub</code>, the algorithm
will scale up <code>lambdaub</code> accordingly.</p></td>
    </tr>
    <tr>
      <th>maxlambdaiter</th>
      <td><p>numeric: the maximum number of iterations allowed to solve
for lambda(s).</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>numeric: the convergence threshold. A lambda is said to satisfy the
mean constraint if the absolute difference between the calculated mean and a fitted
values is less than tol.</p></td>
    </tr>
    <tr>
      <th>contrasts_mu, contrasts_nu</th>
      <td><p>optional lists. See the contrasts.arg of model.matrix.default.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A fitted model object of class <code>cmp</code> similar to one obtained from <code>glm</code>
or <code>glm.nb</code>.</p>
<p>The function <code>summary</code> (i.e., <code><a href='summary.cmp.html'>summary.cmp</a></code>) can be used to obtain
and print a summary of the results.</p>
<p>The functions <code>plot</code> (i.e., <code><a href='plot.cmp.html'>plot.cmp</a></code>) and
<code>gg_plot</code> can be used to produce a range
of diagnostic plots.</p>
<p>The generic assessor functions <code>coef</code> (i.e., <code><a href='coef.cmp.html'>coef.cmp</a></code>),
<code>logLik</code> (i.e., <code><a href='logLik.cmp.html'>logLik.cmp</a></code>)
<code>fitted</code> (i.e., <code><a href='fitted.cmp.html'>fitted.cmp</a></code>),
<code>nobs</code> (i.e., <code><a href='nobs.cmp.html'>nobs.cmp</a></code>),
<code>AIC</code> (i.e., <code><a href='AIC.cmp.html'>AIC.cmp</a></code>) and
<code>residuals</code> (i.e., <code><a href='residuals.cmp.html'>residuals.cmp</a></code>)
can be used to extract various useful features of the value
returned by <code>glm.cmp</code>.</p>
<p>The functions <code>LRTnu</code> and <code>cmplrtest</code> can be used to perform a likelihood ratio
chi-squared test for nu = 1 and for nested COM-Poisson model respectively.</p>
<p>An object class 'glm.cmp' is a list containing at least the following components:</p>
<dt>coefficients</dt><dd><p>a named vector of coefficients</p></dd>
<dt>coefficients_beta</dt><dd><p>a named vector of mean coefficients</p></dd>
<dt>coefficients_gamma</dt><dd><p>a named vector of dispersion coefficients</p></dd>
<dt>se_beta</dt><dd><p>approximate standard errors (using observed rather than expected information) for mean coefficients</p></dd>
<dt>se_gamma</dt><dd><p>approximate standard errors (using observed rather than expected information) for dispersion coefficients</p></dd>
<dt>residuals</dt><dd><p>the <em>response</em> residuals (i.e., observed-fitted)</p></dd>
<dt>fitted_values</dt><dd><p>the fitted mean values</p></dd>
<dt>rank_mu</dt><dd><p>the numeric rank of the fitted linear model for mean</p></dd>
<dt>rank_nu</dt><dd><p>the numeric rank of the fitted linear model for dispersion</p></dd>
<dt>linear_predictors</dt><dd><p>the linear fit for mean on log scale</p></dd>
<dt>df_residuals</dt><dd><p>the residuals degrees of freedom</p></dd>
<dt>df_null</dt><dd><p>the residual degrees of freedom for the null model</p></dd>
<dt>null_deviance</dt><dd><p>The deviance for the null model.
The null model will include only the intercept.</p></dd>
<dt>y</dt><dd><p>the <code>y</code> vector used.</p></dd>
<dt>x</dt><dd><p>the model matrix for mean</p></dd>
<dt>s</dt><dd><p>the model matrix for dispersion</p></dd>
<dt>model_mu</dt><dd><p>the model frame for mu</p></dd>
<dt>model_nu</dt><dd><p>the model frame for nu</p></dd>
<dt>call</dt><dd><p>the matched call</p></dd>
<dt>formula</dt><dd><p>the formula supplied for mean</p></dd>
<dt>formula_nu</dt><dd><p>the formula supplied for dispersion</p></dd>
<dt>terms_mu</dt><dd><p>the <code>terms</code> object used for mean</p></dd>
<dt>terms_nu</dt><dd><p>the <code>terms</code> object used for dispersion</p></dd>
<dt>data</dt><dd><p>the <code>data</code> argument</p></dd>
<dt>offset</dt><dd><p>the <code>offset</code> vector used</p></dd>
<dt>lambdaub</dt><dd><p>the final <code>lambdaub</code> used</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Fit a mean-parametrized COM-Poisson regression using maximum likelihood estimation
via an iterative Fisher Scoring algorithm.</p>
<p>Currently, the COM-Poisson regression model allows constant dispersion and regression being linked to the dispersion parameter i.e. varying dispersion.</p>
<p>For the constant dispersion model, the model is</p>
<p>Y_i ~ CMP(mu_i, nu),</p>
<p>where</p>
<p>E(Y_i) = mu_i = exp(x_i^T beta),</p>
<p>and <em>nu &gt; 0</em> is the dispersion parameter.</p>
<p>The fitted COM-Poisson distribution is over- or under-dispersed
if <em>nu &lt; 1</em> and <em>nu &gt; 1</em> respectively.</p>
<p>For the varying dispersion model, the model is</p>
<p>Y_i ~ CMP(mu_i, nu_i),</p>
<p>where</p>
<p>E(Y_i) = mu_i = exp(x_i^T beta),</p>
<p>and dispersion parameters are model via</p>
<p>nu_i = exp(s_i^T gamma).</p>
<p>where x_i and s_i are some covariates.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fung, T., Alwan, A., Wishart, J. and Huang, A. (2020). <code>mpcmp</code>: Mean-parametrized
Conway-Maxwell Poisson Regression. R package version 0.3.4.</p>
<p>Huang, A. (2017). Mean-parametrized Conway-Maxwell-Poisson regression models for
dispersed counts. <em>Statistical Modelling</em> <b>17</b>, 359--380.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.cmp.html'>summary.cmp</a></code>, <code><a href='plot.cmp.html'>plot.cmp</a></code>,  <code><a href='gg_plot.html'>gg_plot</a></code>, <code><a href='fitted.cmp.html'>fitted.cmp</a></code>,
<code><a href='residuals.cmp.html'>residuals.cmp</a></code> and <code><a href='LRTnu.html'>LRTnu</a></code>.</p>
<p>Additional examples may be found in <code><a href='fish.html'>fish</a></code>,
 <code><a href='takeoverbids.html'>takeoverbids</a></code>, <code><a href='cottonbolls.html'>cottonbolls</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>### Huang (2017) Page 368--370: Overdispersed Attendance data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>attendance</span>)
<span class='kw'>M.attendance</span> <span class='op'>&lt;-</span> <span class='fu'>glm.cmp</span>(<span class='kw'>daysabs</span><span class='op'>~</span> <span class='kw'>gender</span><span class='op'>+</span><span class='kw'>math</span><span class='op'>+</span><span class='kw'>prog</span>, data=<span class='kw'>attendance</span>)
<span class='kw'>M.attendance</span></div><div class='output co'>#&gt; 
#&gt; Call: glm.cmp(formula = daysabs ~ gender + math + prog, data = attendance)
#&gt; 
#&gt; Linear Model Coefficients:
#&gt;    (Intercept)      gendermale            math    progAcademic  progVocational  
#&gt;       2.714600       -0.214720       -0.006323       -0.425320       -1.253900  
#&gt; 
#&gt; Dispersion (nu): 0.0202
#&gt; Degrees of Freedom: 313 Total (i.e. Null);  309 Residual
#&gt; Null Deviance: 455.8326 
#&gt; Residual Deviance: 377.4413 
#&gt; AIC: 1739.026 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>M.attendance</span>)</div><div class='output co'>#&gt; 
#&gt; Call: glm.cmp(formula = daysabs ~ gender + math + prog, data = attendance)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -2.1925  -1.1166  -0.3973   0.2964   2.8154  
#&gt; 
#&gt; Linear Model Coefficients:
#&gt;                Estimate Std.Err Z value Pr(&gt;|z|)    
#&gt; (Intercept)      2.7146  0.1904   14.26  &lt; 2e-16 ***
#&gt; gendermale      -0.2147  0.1171   -1.83    0.067 .  
#&gt; math            -0.0063  0.0024   -2.65    0.008 ** 
#&gt; progAcademic    -0.4253  0.1695   -2.51    0.012 *  
#&gt; progVocational  -1.2539  0.1895   -6.62  3.7e-11 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; (Dispersion parameter for Mean-CMP estimated to be  0.02024 )
#&gt; 
#&gt; 
#&gt;     Null deviance: 455.83  on 313 degrees of freedom
#&gt; Residual deviance: 377.44  on 309 degrees of freedom
#&gt; 
#&gt; AIC: 1739.026 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>M.attendance</span>) <span class='co'># or gg_plot(M.attendance)</span></div><div class='img'><img src='glm.cmp-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='glm.cmp-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='glm.cmp-3.png' alt='' width='700' height='433' /></div><div class='img'><img src='glm.cmp-4.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>### Ribeiro et al. (2013): Varying dispersion as a function of covariates</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>sitophilus</span>)
<span class='kw'>M.sit</span> <span class='op'>&lt;-</span> <span class='fu'>glm.cmp</span>(formula = <span class='kw'>ninsect</span> <span class='op'>~</span> <span class='kw'>extract</span>, formula_nu = <span class='op'>~</span><span class='kw'>extract</span>, data = <span class='kw'>sitophilus</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='kw'>M.sit</span>)</div><div class='output co'>#&gt; 
#&gt; Call: glm.cmp(formula = ninsect ~ extract, formula_nu = ~extract, data = sitophilus)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;      Min        1Q    Median        3Q       Max  
#&gt; -2.21085  -1.16849   0.07494   0.64152   1.72653  
#&gt; 
#&gt; Mean Model Coefficients:
#&gt;               Estimate Std.Err Z value Pr(&gt;|z|)    
#&gt; (Intercept)     3.4500  0.0780   44.25   &lt;2e-16 ***
#&gt; extractLeaf    -0.0064  0.1221   -0.05     0.96    
#&gt; extractBranch  -0.0521  0.1234   -0.42     0.67    
#&gt; extractSeed    -3.3547  0.3621   -9.26   &lt;2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Dispersion Model Coefficients:
#&gt;               Estimate Std.Err Z value Pr(&gt;|z|)
#&gt; (Intercept)     -0.665   0.457   -1.45     0.15
#&gt; extractLeaf     -0.383   0.651   -0.59     0.56
#&gt; extractBranch   -0.372   0.651   -0.57     0.57
#&gt; extractSeed     -0.118   1.546   -0.08     0.94
#&gt; 
#&gt;     Null deviance: 257.211  on 39 degrees of freedom
#&gt; Residual deviance:  41.679  on 32 degrees of freedom
#&gt; 
#&gt; AIC: 260.8279 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thomas Fung, Aya Alwan, Justin Wishart, Alan Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


