<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with the `mpcmp` package • mpcmp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with the `mpcmp` package">
<meta property="og:description" content="mpcmp">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mpcmp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/mpcmp.html">Tutorial</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thomas-fung/mpcmp" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/people.html">
    <span class="fa fa-info-circle fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mpcmp_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="mpcmp_files/kePrint-0.0.1/kePrint.js"></script><link href="mpcmp_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with the <code>mpcmp</code> package</h1>
                        <h4 data-toc-skip class="author">Thomas Fung, Aya Alwan, Justin Wishart and Alan Huang</h4>
            
            <h4 data-toc-skip class="date">2021-07-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thomas-fung/mpcmp/blob/master/vignettes/mpcmp.Rmd" class="external-link"><code>vignettes/mpcmp.Rmd</code></a></small>
      <div class="hidden name"><code>mpcmp.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor" aria-hidden="true"></a>Introduction</h2>
<p>Conway–Maxwell–Poisson (CMP or COM-Poisson) distributions have seen a recent resurgence in popularity for the analysis of dispersed counts (e.g., <span class="citation">Shmueli et al. (2005)</span>; <span class="citation">Lord, Guikema, and Geedipally (2008)</span>; <span class="citation">Lord, Geedipally, and Guikema (2010)</span>; <span class="citation">Sellers and Shmueli (2010)</span>; <span class="citation">Sellers and Premeaux (2020)</span>). Key features of CMP distributions include the ability to handle both over- and under-dispersion while containing the classical Poisson distribution as a special case. See the corresponding <a href="https://en.wikipedia.org/wiki/Conway%E2%80%93Maxwell%E2%80%93Poisson_distribution" class="external-link">Wikipedia</a> page for a quick summary or <span class="citation">Shmueli et al. (2005)</span> for a more detailed overview of the history, features and applications of CMP distributions.</p>
<p>The R (<span class="citation">R Core Team (2020)</span>) <code>mpcmp</code> package of <span class="citation">Fung et al. (2020)</span> provides the functionality for estimating a mean-parametrized Conway-Maxwell-Poisson generalized linear models for dispersed count data. The package is available from the Comprehensive R Archive Network (CRAN) <a href="http://CRAN.R-project.org/package=mpcmp" class="external-link">here</a>. <span class="citation">Huang (2017)</span> provides the theoretical development of the model that this package bases on.</p>
</div>
<div id="cmpintro" class="section level2">
<h2 class="hasAnchor">
<a href="#cmpintro" class="anchor" aria-hidden="true"></a>Conway-Maxwell-Poisson Distributions</h2>
<p>The CMP distribution was first used by <span class="citation">Conway and Maxwell (1962)</span> as a model for a queuing system with dependent service times. A random variable is said to have a (standard) CMP distribution with rate parameter <span class="math inline">\(\lambda\)</span> and dispersion parameter <span class="math inline">\(\nu\)</span> if its probability mass function (pmf) is given by <span class="math display">\[
P(Y =y|\lambda,\nu)= \frac{\lambda^y}{(y!)^{\nu}}\frac{1}{Z(\lambda,\nu)}, \quad y =0,1,2,...,
\]</span> where <span class="math display">\[
Z(\lambda,\nu)= \sum^{\infty}_{y=0}\frac{\lambda^y}{(y!)^{\nu}},
\]</span> is a normalizing constant. The CMP includes Poisson (<span class="math inline">\(\nu = 1\)</span>), geometric (<span class="math inline">\(\nu = 0\)</span>, <span class="math inline">\(\lambda &lt; 1\)</span>) and Bernoulli (<span class="math inline">\(\nu \to \infty\)</span> with probability <span class="math inline">\(\lambda/(1+\lambda)\)</span>) as its special cases.</p>
<p>One of the major limitations of CMP distributions is that it is not directly parametrized via the mean as it does not have closed-form expression for its moments in terms of the parameters <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\nu\)</span>. For the first two moments, approximations can be obtained as <span class="math display">\[
\begin{aligned}
E(Y)  &amp;\approx \lambda^{\frac{1}{\nu}}-\frac{\nu-1}{2\nu}\quad  \text{and} \quad Var(Y) \approx \frac{1}{\nu}E(Y),
\end{aligned}
\]</span> and they can be particularly accurate for <span class="math inline">\(\nu\leq 1\)</span> or <span class="math inline">\(\lambda&gt;10^{\nu}\)</span> (see <span class="citation">Shmueli et al. (2005)</span>). If <span class="math inline">\(\nu &lt; 1\)</span>, CMP is overdispersed. In reverse, CMP is underdispersed when <span class="math inline">\(\nu&gt;1\)</span>. Here is a plot of the density for a few CMP distributions with mean <span class="math inline">\(\mu = 5\)</span>:</p>
<p><img src="mpcmp_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
</div>
<div id="glm" class="section level2">
<h2 class="hasAnchor">
<a href="#glm" class="anchor" aria-hidden="true"></a>Conway-Maxwell-Poisson Generalized Linear Models</h2>
<p>As CMP is one of a few distributions that can handle both under- and over-dispersion, the aim is to extend the GLM formulation to the CMP case so that one can model the relationship between <span class="math inline">\(Y\)</span> and the predictors <span class="math inline">\(X\)</span>. Given a set of covariates <span class="math inline">\(X \in R^q\)</span>, <span class="citation">Sellers and Shmueli (2010)</span> proposed a GLM for count response <span class="math inline">\(Y\)</span> that can be specified via <span class="math display">\[
Y|X ∼ CMP(\lambda,\nu), \quad \text{s.t.} \quad \log\lambda = X^{\top}\beta
\]</span> where <span class="math inline">\(\beta \in R^q\)</span> is a vector of regression coefficients. This model, however, does not provide a closed-form relationship between <span class="math inline">\(E(Y)\)</span> and the linear predictor, making it incompatible with other commonly used log-linear models.</p>
<p>As it is more convenient and interpretable to model the mean <span class="math inline">\(\mu = E(Y)&gt;0\)</span> of the distribution directly, <span class="citation">Huang (2017)</span> proposed to parametrize the CMP distribution via the mean: <span class="math display">\[
P(Y = y|\mu, \nu) = \frac{\lambda(\mu,\nu)^{y}}{(y!)^{\nu}}\frac{1}{Z(\lambda(\mu,\nu),\nu)}, \quad y = 0,1,2,\ldots,
\]</span> where the rate <span class="math inline">\(\lambda(\mu,\nu)\)</span> is defined as the solution to the mean constraint: <span class="math display">\[
 \mu= \sum^{\infty}_{y=0} y\frac{\lambda^y}{(y!)^{\nu}}\frac{1}{Z(\lambda,\nu)}.
\]</span> We shall denote this as CMP<span class="math inline">\(_{\mu}(\mu, \nu)\)</span> distribution to distinguish it from the original/standard one.</p>
<p>A GLM that based on CMP<span class="math inline">\(_{\mu}\)</span> can then be specified via <span class="math display">\[
Y|X ∼ CMP_{\mu}(\mu(X^{\top}\beta),\nu), 
\]</span> where <span class="math display">\[
E(Y|X) = \mu(X^{\top}\beta) = \exp(X^{\top}\beta).
\]</span> Note that GLM that based on CMP<span class="math inline">\(_{\mu}\)</span> is a genuine GLM, so all the familiar key features of GLMs (e.g., <span class="citation">McCullagh and Nelder (1989)</span>, Chapter 2) are retained.</p>
<p>The mean-dispersion specification makes CMP<span class="math inline">\(_{\mu}\)</span> directly comparable and compatible other commonly used log-linear regression models for counts. In particular, the mean <span class="math inline">\(\mu = \exp(X^{\top}\beta)\)</span> is functionally independent of the dispersion parameter <span class="math inline">\(\nu\)</span>, making it similar in structure to the familiar Negative Binomial regression model for overdispersed counts.</p>
<p>The model can also be extended to allow varying dispersion, i.e. <span class="math inline">\(\nu\)</span> itself is modelled via a regression: <span class="math display">\[
\nu = \exp(\tilde{X}^{\top}\gamma),
\]</span> where <span class="math inline">\(\tilde{X}\)</span> is some covariates.</p>
</div>
<div id="the-mpcmp-package" class="section level2">
<h2 class="hasAnchor">
<a href="#the-mpcmp-package" class="anchor" aria-hidden="true"></a>The <code>mpcmp</code> package</h2>
<p>The main modelling function in our <code>mpcmp</code> package is <code><a href="../reference/glm.cmp.html">glm.cmp()</a></code>. The optimisation is done using Fisher Scoring updates to take advantage of the fact the CMP<span class="math inline">\(_{\mu}\)</span> belongs to the exponential family. Notice that this is a constrained optimisation problem as we have to maintain mean constraints at all times, which makes the implementation is a bit more challenging.</p>
<p>The package implements similar methods to those related to <code>glm</code> objects. If you used <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> previously, you should feel right at home. Once a fitted model object has been obtained, there are assessor functions available to extract the coefficients (<code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef()</a></code>, or its alias <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients()</a></code>), the fitted values (<code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted()</a></code> or its alias <code><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted.values()</a></code>), the residuals (<code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code> or its alias <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid()</a></code>), the model frame (<code><a href="https://rdrr.io/r/stats/model.frame.html" class="external-link">model.frame()</a></code>), the number of observations (nobs()), the log-likelihood (<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik()</a></code>), and the AIC (<code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code>).</p>
<p>You can also use <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> to obtain diagnostic plots of the fitted model.</p>
<p>Let’s go through some examples to show you what our package can do!</p>
</div>
<div id="constant-overdispersion-example-attendance" class="section level2">
<h2 class="hasAnchor">
<a href="#constant-overdispersion-example-attendance" class="anchor" aria-hidden="true"></a>Constant Overdispersion Example: <code>attendance</code>
</h2>
<p>The <code>attendance</code> dataset (originally from <a href="https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/" class="external-link">https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/</a>) examines the relationship between the number of days absent from school and the gender, maths score and academic program of 314 students from two urban high schools.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/thomas-fung/mpcmp" class="external-link">mpcmp</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">attendance</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">attendance</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">daysabs</span>, fill <span class="op">=</span> <span class="va">prog</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">prog</span> <span class="op">~</span> <span class="va">.</span>, margins <span class="op">=</span> <span class="cn">TRUE</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="mpcmp_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>It appears students enrolled into the General program tend to miss more days of school than those enrolled into the Academic or the Vocational program. There is some overdispersion in this dataset. We can use <code><a href="../reference/glm.cmp.html">glm.cmp()</a></code> to fit the mean-parametrized CMP model to try to account for that overdispersion.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M.attendance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glm.cmp.html">glm.cmp</a></span><span class="op">(</span><span class="va">daysabs</span><span class="op">~</span> <span class="va">gender</span><span class="op">+</span><span class="va">math</span><span class="op">+</span><span class="va">prog</span>, data<span class="op">=</span><span class="va">attendance</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M.attendance</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: glm.cmp(formula = daysabs ~ gender + math + prog, data = attendance)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -2.1925  -1.1166  -0.3973   0.2964   2.8154  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Model Coefficients:</span>
<span class="co">#&gt;                 Estimate   Std.Err Z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     2.714645  0.190407  14.257  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale     -0.214720  0.117148  -1.833  0.06682 .  </span>
<span class="co">#&gt; math           -0.006323  0.002386  -2.650  0.00804 ** </span>
<span class="co">#&gt; progAcademic   -0.425322  0.169525  -2.509  0.01211 *  </span>
<span class="co">#&gt; progVocational -1.253896  0.189478  -6.618 3.65e-11 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for Mean-CMP estimated to be 0.02024)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 455.83  on 313 degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 377.44  on 309 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 1739.026</span></code></pre></div>
<p>As <code>mpcmp</code> is directly comparable and compatible with other commonly used log-linear regression models for counts, interpreting parameters is straight forward. Our model estimates that students in the General program (the reference level) are expected to miss exp(+1.254) = 3.5 times more days of school compared to students in the Vocational program.</p>
<p>To see whether a simpler Poisson model, i.e. <span class="math inline">\(\nu = 1\)</span> is adequate, we can run the model through the <code><a href="../reference/LRTnu.html">LRTnu()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/LRTnu.html">LRTnu</a></span><span class="op">(</span><span class="va">M.attendance</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Likelihood ratio test for testing nu=1:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Log-Likelihood for Mean-CMP(0.0202406): -864</span>
<span class="co">#&gt; Log-Likelihood for Poisson: -1320</span>
<span class="co">#&gt; LRT-statistic: 903</span>
<span class="co">#&gt; Chi-sq degrees of freedom: 1</span>
<span class="co">#&gt; P-value: &lt; 2e-16</span></code></pre></div>
<p>As the P-value is small, we conclude that dispersion is present in this data set.</p>
<p>One of the key features of the <code>mpcmp</code> package is that it provides a range of diagnostic plots.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">M.attendance</span><span class="op">)</span></code></pre></div>
<p><img src="mpcmp_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Please refer to <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">?autoplot</a></code> to see what diagnostic plots are available for a <code>cmp</code> class object.</p>
<p>The <code>mpcmp</code> package also supports <code>broom</code> <code>tidier</code> method.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">M.attendance</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 5 x 5</span>
<span class="co">#&gt;   term           estimate std.error statistic  p.value</span>
<span class="co">#&gt;   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 (Intercept)     2.71      0.190       14.3  4.05e-46</span>
<span class="co">#&gt; 2 gendermale     -0.215     0.117       -1.83 6.68e- 2</span>
<span class="co">#&gt; 3 math           -0.00632   0.00239     -2.65 8.04e- 3</span>
<span class="co">#&gt; 4 progAcademic   -0.425     0.170       -2.51 1.21e- 2</span>
<span class="co">#&gt; 5 progVocational -1.25      0.189       -6.62 3.65e-11</span></code></pre></div>
<p>This means “cmp” objects can take advantage of any packages that required <code>broom</code> support such as the <code>modelsummary</code> package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M_poisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">daysabs</span><span class="op">~</span> <span class="va">gender</span><span class="op">+</span><span class="va">math</span><span class="op">+</span><span class="va">prog</span>, data<span class="op">=</span><span class="va">attendance</span>, family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span>
<span class="va">M_nb</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html" class="external-link">glm.nb</a></span><span class="op">(</span><span class="va">daysabs</span><span class="op">~</span> <span class="va">gender</span><span class="op">+</span><span class="va">math</span><span class="op">+</span><span class="va">prog</span>, data<span class="op">=</span><span class="va">attendance</span><span class="op">)</span>
<span class="fu">modelsummary</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mpcmp <span class="op">=</span> <span class="va">M.attendance</span>, 
                                Poisson <span class="op">=</span> <span class="va">M_poisson</span>, 
                                Neg.Bin <span class="op">=</span> <span class="va">M_nb</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mpcmp
</th>
<th style="text-align:center;">
Poisson
</th>
<th style="text-align:center;">
Neg.Bin
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
2.715
</td>
<td style="text-align:center;">
2.759
</td>
<td style="text-align:center;">
2.707
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.190)
</td>
<td style="text-align:center;">
(0.064)
</td>
<td style="text-align:center;">
(0.204)
</td>
</tr>
<tr>
<td style="text-align:left;">
gendermale
</td>
<td style="text-align:center;">
-0.215
</td>
<td style="text-align:center;">
-0.242
</td>
<td style="text-align:center;">
-0.211
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.117)
</td>
<td style="text-align:center;">
(0.047)
</td>
<td style="text-align:center;">
(0.122)
</td>
</tr>
<tr>
<td style="text-align:left;">
math
</td>
<td style="text-align:center;">
-0.006
</td>
<td style="text-align:center;">
-0.007
</td>
<td style="text-align:center;">
-0.006
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.002)
</td>
<td style="text-align:center;">
(0.001)
</td>
<td style="text-align:center;">
(0.002)
</td>
</tr>
<tr>
<td style="text-align:left;">
progAcademic
</td>
<td style="text-align:center;">
-0.425
</td>
<td style="text-align:center;">
-0.426
</td>
<td style="text-align:center;">
-0.425
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.170)
</td>
<td style="text-align:center;">
(0.057)
</td>
<td style="text-align:center;">
(0.182)
</td>
</tr>
<tr>
<td style="text-align:left;">
progVocational
</td>
<td style="text-align:center;">
-1.254
</td>
<td style="text-align:center;">
-1.271
</td>
<td style="text-align:center;">
-1.253
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.189)
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.078)
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.200)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
314
</td>
<td style="text-align:center;">
314
</td>
<td style="text-align:center;">
314
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
1739.0
</td>
<td style="text-align:center;">
2640.2
</td>
<td style="text-align:center;">
1740.3
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
1761.5
</td>
<td style="text-align:center;">
2658.9
</td>
<td style="text-align:center;">
1762.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
-863.513
</td>
<td style="text-align:center;">
-1315.089
</td>
<td style="text-align:center;">
-864.154
</td>
</tr>
</tbody>
</table>
<p>We also implemented a bunch of commonly used methods for “cmp” objects:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"cmp"</span><span class="op">)</span>
<span class="co">#&gt;  [1] AIC            augment        autoplot       coef           confint       </span>
<span class="co">#&gt;  [6] cooks.distance fitted         glance         hatvalues      influence     </span>
<span class="co">#&gt; [11] logLik         model.frame    model.matrix   nobs           plot          </span>
<span class="co">#&gt; [16] predict        print          residuals      rstandard      summary       </span>
<span class="co">#&gt; [21] tidy           update         vcov          </span>
<span class="co">#&gt; see '?methods' for accessing help and source code</span></code></pre></div>
</div>
<div id="constant-underdispersion-example-takeoverbids" class="section level2">
<h2 class="hasAnchor">
<a href="#constant-underdispersion-example-takeoverbids" class="anchor" aria-hidden="true"></a>Constant Underdispersion Example: <code>takeoverbids</code>
</h2>
<p>One of the key strength of the CMP distribution is that it can handle underdispersion. Here is an example demonstrating that. A dataset from <span class="citation">Cameron and Johansson (1997)</span> that gives the number of bids received by 126 US firms that were successful targets of tender offers during the period 1978-85. The dataset comes with a set of explanatory variables such as defensive actions taken by management of target firm, firm-specific characteristics and intervention by federal regulators.</p>
<p>If we fit a Poisson distribution to the marginal distribution of the number of bids, we have:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"takeoverbids"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">takeoverbids</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">numbids</span>, y <span class="op">=</span> <span class="va">..count..</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">numbids</span>,  
                        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="va">numbids</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">numbids</span><span class="op">)</span><span class="op">)</span>, 
                        ymin <span class="op">=</span> <span class="fl">0</span>, 
                        ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="va">numbids</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">numbids</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
                  colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of bids with Poisson fit"</span>, y <span class="op">=</span> <span class="st">"Probability"</span><span class="op">)</span></code></pre></div>
<p><img src="mpcmp_files/figure-html/unnamed-chunk-10-1.png" width="700"> We can see that the response variable is more concentrated than a Poisson fit, which is a sign of underdispersion.</p>
<p>Here, we can use <code><a href="../reference/glm.cmp.html">glm.cmp()</a></code> to fit the mean-parametrized CMP model to try to account for that underdispersion.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M.bids</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glm.cmp.html">glm.cmp</a></span><span class="op">(</span><span class="va">numbids</span> <span class="op">~</span> <span class="va">leglrest</span> <span class="op">+</span> <span class="va">rearest</span> <span class="op">+</span> <span class="va">finrest</span> <span class="op">+</span> <span class="va">whtknght</span>
    <span class="op">+</span> <span class="va">bidprem</span> <span class="op">+</span> <span class="va">insthold</span> <span class="op">+</span> <span class="va">size</span> <span class="op">+</span> <span class="va">sizesq</span> <span class="op">+</span> <span class="va">regulatn</span>, data<span class="op">=</span><span class="va">takeoverbids</span><span class="op">)</span>
<span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">M.bids</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 5</span>
<span class="co">#&gt;    term        estimate std.error statistic  p.value</span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt;  1 (Intercept)  0.990     0.435       2.27  0.0230  </span>
<span class="co">#&gt;  2 leglrest     0.268     0.123       2.18  0.0292  </span>
<span class="co">#&gt;  3 rearest     -0.173     0.155      -1.12  0.263   </span>
<span class="co">#&gt;  4 finrest      0.0677    0.174       0.388 0.698   </span>
<span class="co">#&gt;  5 whtknght     0.481     0.132       3.65  0.000258</span>
<span class="co">#&gt;  6 bidprem     -0.685     0.308      -2.23  0.0260  </span>
<span class="co">#&gt;  7 insthold    -0.368     0.347      -1.06  0.289   </span>
<span class="co">#&gt;  8 size         0.179     0.0476      3.77  0.000166</span>
<span class="co">#&gt;  9 sizesq      -0.00758   0.00248    -3.05  0.00228 </span>
<span class="co">#&gt; 10 regulatn    -0.0376    0.130      -0.288 0.773</span>
<span class="fu"><a href="../reference/LRTnu.html">LRTnu</a></span><span class="op">(</span><span class="va">M.bids</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Likelihood ratio test for testing nu=1:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Log-Likelihood for Mean-CMP(1.75214): -180</span>
<span class="co">#&gt; Log-Likelihood for Poisson: -185</span>
<span class="co">#&gt; LRT-statistic: 9.72</span>
<span class="co">#&gt; Chi-sq degrees of freedom: 1</span>
<span class="co">#&gt; P-value: 0.00182</span></code></pre></div>
<p>From the likelihood ratio test, we can see that the dispersion parameter is significantly different to 1, suggesting the model is trying to account for that underdispersion.</p>
<p>We can also compare the results with a Poisson model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M.bids.pois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">numbids</span> <span class="op">~</span> <span class="va">leglrest</span> <span class="op">+</span> <span class="va">rearest</span> <span class="op">+</span> <span class="va">finrest</span> <span class="op">+</span> <span class="va">whtknght</span>
    <span class="op">+</span> <span class="va">bidprem</span> <span class="op">+</span> <span class="va">insthold</span> <span class="op">+</span> <span class="va">size</span> <span class="op">+</span> <span class="va">sizesq</span> <span class="op">+</span> <span class="va">regulatn</span>, data<span class="op">=</span><span class="va">takeoverbids</span>,
    family <span class="op">=</span> <span class="va">poisson</span><span class="op">)</span>
<span class="fu">modelsummary</span><span class="fu">::</span><span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/modelsummary.html" class="external-link">modelsummary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mpcmp <span class="op">=</span> <span class="va">M.bids</span>, Poisson <span class="op">=</span> <span class="va">M.bids.pois</span><span class="op">)</span>,
                           statistic_vertical <span class="op">=</span> <span class="cn">FALSE</span>, stars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Warning in sanity_ellipsis(vcov, ...): The `statistic_vertical` argument</span>
<span class="co">#&gt; is deprecated and will be ignored. To display uncertainty estimates next to</span>
<span class="co">#&gt; your coefficients, use a `glue` string in the `estimate` argument. See `?</span>
<span class="co">#&gt; modelsummary`</span>
<span class="co">#&gt; Warning: In version 0.8.0 of the `modelsummary` package, the default significance markers produced by the `stars=TRUE` argument were changed to be consistent with R's defaults.</span>
<span class="co">#&gt; This warning is displayed once per session.</span></code></pre></div>
<table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
mpcmp
</th>
<th style="text-align:center;">
Poisson
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
0.990*
</td>
<td style="text-align:center;">
0.986+
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.435)
</td>
<td style="text-align:center;">
(0.534)
</td>
</tr>
<tr>
<td style="text-align:left;">
leglrest
</td>
<td style="text-align:center;">
0.268*
</td>
<td style="text-align:center;">
0.260+
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.123)
</td>
<td style="text-align:center;">
(0.151)
</td>
</tr>
<tr>
<td style="text-align:left;">
rearest
</td>
<td style="text-align:center;">
-0.173
</td>
<td style="text-align:center;">
-0.196
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.155)
</td>
<td style="text-align:center;">
(0.193)
</td>
</tr>
<tr>
<td style="text-align:left;">
finrest
</td>
<td style="text-align:center;">
0.068
</td>
<td style="text-align:center;">
0.074
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.174)
</td>
<td style="text-align:center;">
(0.217)
</td>
</tr>
<tr>
<td style="text-align:left;">
whtknght
</td>
<td style="text-align:center;">
0.481***
</td>
<td style="text-align:center;">
0.481**
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.132)
</td>
<td style="text-align:center;">
(0.159)
</td>
</tr>
<tr>
<td style="text-align:left;">
bidprem
</td>
<td style="text-align:center;">
-0.685*
</td>
<td style="text-align:center;">
-0.678+
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.308)
</td>
<td style="text-align:center;">
(0.377)
</td>
</tr>
<tr>
<td style="text-align:left;">
insthold
</td>
<td style="text-align:center;">
-0.368
</td>
<td style="text-align:center;">
-0.362
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.347)
</td>
<td style="text-align:center;">
(0.424)
</td>
</tr>
<tr>
<td style="text-align:left;">
size
</td>
<td style="text-align:center;">
0.179***
</td>
<td style="text-align:center;">
0.179**
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.048)
</td>
<td style="text-align:center;">
(0.060)
</td>
</tr>
<tr>
<td style="text-align:left;">
sizesq
</td>
<td style="text-align:center;">
-0.008**
</td>
<td style="text-align:center;">
-0.008*
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(0.002)
</td>
<td style="text-align:center;">
(0.003)
</td>
</tr>
<tr>
<td style="text-align:left;">
regulatn
</td>
<td style="text-align:center;">
-0.038
</td>
<td style="text-align:center;">
-0.029
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.130)
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(0.161)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
126
</td>
<td style="text-align:center;">
126
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
382.2
</td>
<td style="text-align:center;">
389.9
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
413.4
</td>
<td style="text-align:center;">
418.3
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
-180.088
</td>
<td style="text-align:center;">
-184.948
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> + p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001
</td>
</tr></tfoot>
</table>
<p>If we compare the two models, we can see that the CMP<span class="math inline">\(_{\mu}\)</span> model fitted the data better. We can also see that all the estimated standard errors under CMP<span class="math inline">\(_{\mu}\)</span> model are smaller which in turn makes the p-values for both <code>leglrest</code> and <code>bidprem</code> to drop below 0.05 instead of 0.1 under the Poisson model.</p>
</div>
<div id="varying-dispersion-example-sitophilus" class="section level2">
<h2 class="hasAnchor">
<a href="#varying-dispersion-example-sitophilus" class="anchor" aria-hidden="true"></a>Varying Dispersion Example: <code>sitophilus</code>
</h2>
<p><span class="citation">Ribeiro et al. (2013)</span> carried out an experiment to assess the bioactivity of extracts from different parts (seeds, leaves and branches) of Annona mucosa (Annonaceae) to control Sitophilus zeamaus (Coleoptera: Curculionidae), a major pest of stored maize/corn in Brazil. This dataset can be found as part of the <code>cmpreg</code> package of <span class="citation">Elias Ribeiro Junior (2020)</span>.</p>
<p>In this experiment:</p>
<ul>
<li>10g of corn and 20 animals adults were placed in each Petri dish.</li>
<li>Extracts prepared with different parts of mucosa or just water (control) were completely randomised with 10 replicates.</li>
<li>The numbers of emerged insects (progeny) after 60 days were recorded and some descriptive statistics can be found below.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sitophilus</span><span class="op">)</span>
<span class="va">sitophilus</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">extract</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">ninsect</span><span class="op">)</span>, 
                                               sigma2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">ninsect</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   extract    mu sigma2</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Control  31.5  62.5 </span>
<span class="co">#&gt; 2 Leaf     31.3  94.0 </span>
<span class="co">#&gt; 3 Branch   29.9  88.8 </span>
<span class="co">#&gt; 4 Seed      1.1   1.66</span></code></pre></div>
<p>It appears that the treatment may have some impact on both the mean and the variance of the number of progeny. Recall that non-constant variance is the norm in a GLM, non-constant variances do not necessarily mean varying dispersions. Nonetheless, we will try to use the treatment to explain the dispersion in the data set. To do that we specify the <code>formula_nu</code> argument in the <code><a href="../reference/glm.cmp.html">glm.cmp()</a></code> function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sitophilus</span><span class="op">)</span>
<span class="va">M.sit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/glm.cmp.html">glm.cmp</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">ninsect</span> <span class="op">~</span> <span class="va">extract</span>, formula_nu <span class="op">=</span> <span class="op">~</span> <span class="va">extract</span>, data <span class="op">=</span> <span class="va">sitophilus</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M.sit</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: glm.cmp(formula = ninsect ~ extract, formula_nu = ~extract, data = sitophilus)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span>
<span class="co">#&gt; -2.21085  -1.16849   0.07494   0.64152   1.72653  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mean Model Coefficients:</span>
<span class="co">#&gt;                Estimate   Std.Err Z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)    3.449988  0.077974  44.245   &lt;2e-16 ***</span>
<span class="co">#&gt; extractLeaf   -0.006369  0.122139  -0.052    0.958    </span>
<span class="co">#&gt; extractBranch -0.052129  0.123387  -0.422    0.673    </span>
<span class="co">#&gt; extractSeed   -3.354677  0.362108  -9.264   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Dispersion Model Coefficients:</span>
<span class="co">#&gt;               Estimate Std.Err Z value Pr(&gt;|z|)</span>
<span class="co">#&gt; (Intercept)    -0.6652  0.4573  -1.455    0.146</span>
<span class="co">#&gt; extractLeaf    -0.3831  0.6509  -0.589    0.556</span>
<span class="co">#&gt; extractBranch  -0.3724  0.6514  -0.572    0.567</span>
<span class="co">#&gt; extractSeed    -0.1176  1.5461  -0.076    0.939</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 257.211  on 39 degrees of freedom</span>
<span class="co">#&gt; Residual deviance:  41.679  on 32 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 260.8279</span></code></pre></div>
<p>From the model summary, we can see that there is not much evidence to suggest the dispersions are varying across treatment groups. We can also formally test whether a constant dispersion model is sufficient here using a likelihood ratio test as the two models are nested:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">M.sit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">M.sit</span>, formula_nu <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="fu"><a href="../reference/cmplrtest.html">cmplrtest</a></span><span class="op">(</span><span class="va">M.sit</span>, <span class="va">M.sit2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Likelihood ratio test for testing both COM-Poisson models are equivalent</span>
<span class="co">#&gt; LRT-statistic:  0.439 </span>
<span class="co">#&gt; Chi-sq degrees of freedom:  3 </span>
<span class="co">#&gt; P-value:  0.932</span></code></pre></div>
<p>As a result, our final model is</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">M.sit2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: glm.cmp(formula = ninsect ~ extract, data = sitophilus)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -1.9515  -1.2310   0.0794   0.6255   1.6762  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Model Coefficients:</span>
<span class="co">#&gt;                Estimate   Std.Err Z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)    3.449988  0.088455  39.003   &lt;2e-16 ***</span>
<span class="co">#&gt; extractLeaf   -0.006369  0.125289  -0.051    0.959    </span>
<span class="co">#&gt; extractBranch -0.052129  0.126712  -0.411    0.681    </span>
<span class="co">#&gt; extractSeed   -3.354677  0.372197  -9.013   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for Mean-CMP estimated to be 0.3957)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 234.470  on 39 degrees of freedom</span>
<span class="co">#&gt; Residual deviance:  41.408  on 36 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 253.2668</span></code></pre></div>
</div>
<div id="other-packages-for-fitting-conway-maxwell-poisson-model" class="section level2">
<h2 class="hasAnchor">
<a href="#other-packages-for-fitting-conway-maxwell-poisson-model" class="anchor" aria-hidden="true"></a>Other packages for fitting Conway-Maxwell Poisson Model</h2>
<p>There are other <code>R</code> packages to deal with CMP models, and they all contribute to the writing and construction of this package.</p>
<ul>
<li>
<code>compoisson</code>: Routines for density and moments of the CMP distribution under original parametrization by <span class="citation">Dunn (2012)</span>
</li>
<li>
<code>CompGLM</code>: Fit CMP models under original parametrization (includes dispersion modelling) by <span class="citation">Pollock (2018)</span>.</li>
<li>
<code>COMPoissonReg</code>: Fit CMP models under original parametrization (includes zero-inflation and dispersion modelling) by <span class="citation">Andrew Raim &lt;andrew.raim@gmail.com&gt; (2019)</span>.</li>
<li>
<code>cmpreg</code>: Fit Mean-type parametrized CMP models (includes dispersion modelling) by <span class="citation">Elias Ribeiro Junior (2020)</span>. The authors purposed to regress on the approximated mean.</li>
<li>
<code>DGLMExtPois</code>: Fit mean-parametrized CMP model (includes dispersion modelling) using <code>nloptr</code> by <span class="citation">Saez-Castillo, Conde-Sanchez, and Martinez (2020)</span>.</li>
<li>
<code>glmmTMB</code>: Fit (among other) CMP models under a different mean-parametrization (includes zero-inflation, dispersion modelling and random effects) by <span class="citation">Brooks et al. (2017)</span>.</li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor" aria-hidden="true"></a>References</h2>
<div id="refs" class="references">
<div id="ref-R-COMPoissonReg">
<p>Andrew Raim &lt;andrew.raim@gmail.com&gt;, Kimberly Sellers Thomas Lotze &lt;thomas.lotze@thomaslotze.com&gt;. 2019. <em>COMPoissonReg: Conway-Maxwell Poisson (Com-Poisson) Regression</em>. <a href="https://CRAN.R-project.org/package=COMPoissonReg" class="external-link">https://CRAN.R-project.org/package=COMPoissonReg</a>.</p>
</div>
<div id="ref-R-glmmTMB">
<p>Brooks, Mollie E., Kasper Kristensen, Koen J. van Benthem, Arni Magnusson, Casper W. Berg, Anders Nielsen, Hans J. Skaug, Martin Maechler, and Benjamin M. Bolker. 2017. “glmmTMB Balances Speed and Flexibility Among Packages for Zero-Inflated Generalized Linear Mixed Modeling.” <em>The R Journal</em> 9 (2): 378–400. <a href="https://journal.r-project.org/archive/2017/RJ-2017-066/index.html" class="external-link">https://journal.r-project.org/archive/2017/RJ-2017-066/index.html</a>.</p>
</div>
<div id="ref-Cameron1997a">
<p>Cameron, A. Colin, and Per Johansson. 1997. “Count data regression using series expansions: With applications.” <em>Journal of Applied Econometrics</em> 12 (3): 203–23. <a href="https://doi.org/10.1002/(SICI)1099-1255(199705)12:3%3C203::AID-JAE446%3E3.0.CO;2-2" class="external-link">https://doi.org/10.1002/(SICI)1099-1255(199705)12:3&lt;203::AID-JAE446&gt;3.0.CO;2-2</a>.</p>
</div>
<div id="ref-Conway1962">
<p>Conway, R. W., and W. L. Maxwell. 1962. “A queuing model with state dependent service rates.” New York :</p>
</div>
<div id="ref-R-compoisson">
<p>Dunn, Jeffrey. 2012. <em>Compoisson: Conway-Maxwell-Poisson Distribution</em>. <a href="https://CRAN.R-project.org/package=compoisson" class="external-link">https://CRAN.R-project.org/package=compoisson</a>.</p>
</div>
<div id="ref-R-cmpreg">
<p>Elias Ribeiro Junior, Eduardo. 2020. <em>Cmpreg: Reparametrized Com-Poisson Regression Models</em>.</p>
</div>
<div id="ref-R-mpcmp">
<p>Fung, Thomas, Aya Alwan, Justin Wishart, and Alan Huang. 2020. <em>Mpcmp: Mean-Parametrizied Conway-Maxwell Poisson Regression</em>. <a href="https://cran.r-project.org/web/packages/mpcmp/index.html" class="external-link">https://cran.r-project.org/web/packages/mpcmp/index.html</a>.</p>
</div>
<div id="ref-Huang2017b">
<p>Huang, Alan. 2017. “Mean-parametrized Conway–Maxwell–Poisson regression models for dispersed counts.” <em>Statistical Modelling</em> 17 (6): 359–80. <a href="https://doi.org/10.1177/1471082X17697749" class="external-link">https://doi.org/10.1177/1471082X17697749</a>.</p>
</div>
<div id="ref-Lord2010a">
<p>Lord, Dominique, Srinivas Reddy Geedipally, and Seth D. Guikema. 2010. “Extension of the application of conway-maxwell-poisson models: Analyzing traffic crash data exhibiting underdispersion.” <em>Risk Analysis</em> 30 (8): 1268–76. <a href="https://doi.org/10.1111/j.1539-6924.2010.01417.x" class="external-link">https://doi.org/10.1111/j.1539-6924.2010.01417.x</a>.</p>
</div>
<div id="ref-Lord2008">
<p>Lord, Dominique, Seth D. Guikema, and Srinivas Reddy Geedipally. 2008. “Application of the Conway-Maxwell-Poisson generalized linear model for analyzing motor vehicle crashes.” <em>Accident Analysis and Prevention</em> 40 (3): 1123–34. <a href="https://doi.org/10.1016/j.aap.2007.12.003" class="external-link">https://doi.org/10.1016/j.aap.2007.12.003</a>.</p>
</div>
<div id="ref-mccullagh1989generalized">
<p>McCullagh, P., and J. A. Nelder. 1989. <em>Generalized Linear Models, Second Edition</em>. Chapman and Hall/Crc Monographs on Statistics and Applied Probability Series. Chapman &amp; Hall. <a href="http://books.google.com/books?id=h9kFH2%5C_FfBkC" class="external-link">http://books.google.com/books?id=h9kFH2\_FfBkC</a>.</p>
</div>
<div id="ref-R-CompGLM">
<p>Pollock, Jeffrey. 2018. <em>CompGLM: Conway-Maxwell-Poisson Glm and Distribution Functions</em>. <a href="https://CRAN.R-project.org/package=CompGLM" class="external-link">https://CRAN.R-project.org/package=CompGLM</a>.</p>
</div>
<div id="ref-R-base">
<p>R Core Team. 2020. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>.</p>
</div>
<div id="ref-Ribeiro2013">
<p>Ribeiro, Leandro do Prado, José Djair Vendramim, Keylla Utherdyany Bicalho, Moacir dos Santos Andrade, João Batista Fernandes, Rafael de Andrade Moral, and Clarice Garcia Borges Demétrio. 2013. “Annona mucosa Jacq. (Annonaceae): A promising source of bioactive compounds against Sitophilus zeamais Mots. (Coleoptera: Curculionidae).” <em>Journal of Stored Products Research</em> 55: 6–14. <a href="https://doi.org/10.1016/j.jspr.2013.06.001" class="external-link">https://doi.org/10.1016/j.jspr.2013.06.001</a>.</p>
</div>
<div id="ref-R-DGLMExtPois">
<p>Saez-Castillo, Antonio Jose, Antonio Conde-Sanchez, and Francisco Martinez. 2020. <em>DGLMExtPois: Double Generalized Linear Models Extending Poisson Regression</em>. <a href="https://CRAN.R-project.org/package=DGLMExtPois" class="external-link">https://CRAN.R-project.org/package=DGLMExtPois</a>.</p>
</div>
<div id="ref-sellersConwayMaxwellPoisson">
<p>Sellers, Kimberly F., and Bailey Premeaux. 2020. “Conway–Maxwell–Poisson Regression Models for Dispersed Count Data.” <em>WIREs Computational Statistics</em>, e1533. <a href="https://doi.org/10.1002/wics.1533" class="external-link">https://doi.org/10.1002/wics.1533</a>.</p>
</div>
<div id="ref-Sellers2010">
<p>Sellers, Kimberly F., and Galit Shmueli. 2010. “A flexible regression model for count data.” <em>Annals of Applied Statistics</em> 4 (2): 943–61. <a href="https://doi.org/10.1214/09-AOAS306" class="external-link">https://doi.org/10.1214/09-AOAS306</a>.</p>
</div>
<div id="ref-Shmueli2005">
<p>Shmueli, G., T. P Minka, J. B Kadane, S. Borle, and P. Boatwright. 2005. “A useful distribution for fitting discrete data:revival of the conway-Maxwell_Poisson distribution.” <em>Applied Statistics</em> 54 (1): 127–42. <a href="https://doi.org/10.1111/j.1467-9876.2005.00474.x" class="external-link">https://doi.org/10.1111/j.1467-9876.2005.00474.x</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Fung, Aya Alwan, Justin Wishart, Alan Huang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
