<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with the `mpcmp` package (under construction) • mpcmp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with the `mpcmp` package (under construction)">
<meta property="og:description" content="mpcmp">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mpcmp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Change log</a>
</li>
<li>
  <a href="../articles/mpcmp.html">Blog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thomas-fung/mpcmp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/people.html">
    <span class="fa fa-info-circle fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mpcmp_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with the <code>mpcmp</code> package (under construction)</h1>
                        <h4 class="author">Thomas Fung, Aya Alwan, Justin Wishart and Alan Huang</h4>
            
            <h4 class="date">2020-07-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thomas-fung/mpcmp/blob/master/vignettes/mpcmp.Rmd"><code>vignettes/mpcmp.Rmd</code></a></small>
      <div class="hidden name"><code>mpcmp.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor"></a>Introduction</h2>
<p>Conway–Maxwell–Poisson (CMP or COM-Poisson) distributions have seen a recent resurgence in popularity for the analysis of dispersed counts (e.g., <span class="citation">Shmueli et al. (2005)</span>; <span class="citation">(<span class="citeproc-not-found" data-reference-id="Lord2008"><strong>???</strong></span>)</span>, <span class="citation">(<span class="citeproc-not-found" data-reference-id="Lord2010"><strong>???</strong></span>)</span>; <span class="citation">Sellers and Shmueli (2010)</span>). Key features of COM-Poisson distributions include the ability to handle both overdispersion and underdispersion, containing the classical Poisson distribution as a special case, and being a continuous bridge between other classical distributions such as the geometric and Bernoulli distributions. See <span class="citation">Shmueli et al. (2005)</span> for a more detailed overview of the history, features and applications of CMP distributions.</p>
<p>The R (<span class="citation">(<span class="citeproc-not-found" data-reference-id="R-base"><strong>???</strong></span>)</span>) <code>mpcmp</code> package (<span class="citation">(<span class="citeproc-not-found" data-reference-id="R-mpcmp"><strong>???</strong></span>)</span>) provides functionality for estimating a mean-parametrized Conway-Maxwell-Poisson generalzied linear models for dispersed count data. The package is available from the Comprehensive R Archive Network (CRAN) <a href="http://CRAN.R-project.org/package=mpcmp">here</a>. <span class="citation">Huang (2017)</span> provides the theoretical development of the model that this package bases on.</p>
</div>
<div id="cmpintro" class="section level2">
<h2 class="hasAnchor">
<a href="#cmpintro" class="anchor"></a>Conway-Maxwell-Poisson Distributions</h2>
<p>The CMP distribution was first used by <span class="citation">(<span class="citeproc-not-found" data-reference-id="Conway1962"><strong>???</strong></span>)</span> as a model for queuing system with dependent service times. A random variable is said to have a (standard) CMP distribution with rate parameter <span class="math inline">\(\lambda\)</span> and dispersion parameter <span class="math inline">\(\nu\)</span> if its probability mass function (pmf) is given by <span class="math display">\[
P(Y =y|λ,ν)= \frac{\lambda^y}{(y!)^{\nu}}\frac{1}{Z(\lambda,\nu)}, \quad y =0,1,2,...,
\]</span> where <span class="math display">\[
Z(\lambda,\nu)= \sum^{\infty}_{y=0}\frac{\lambda^y}{(y!)^{\nu}},
\]</span> is a normalizing constant. The CMP includes Poisson (<span class="math inline">\(\nu = 1\)</span>), geometric (<span class="math inline">\(\nu = 0\)</span>, <span class="math inline">\(\lambda &lt; 1\)</span>) and Bernoulli (<span class="math inline">\(\nu \to \infty\)</span> with probability <span class="math inline">\(\lambda/(1+\lambda)\)</span>).</p>
<p>One of the major limitations of CMP distributions is that it is not directly parametrized via the mean as it does not have closed-form expression for its moments in terms of the parameters <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\nu\)</span>. For the first two moments, approximation can be obtained as <span class="math display">\[
\begin{aligned}
E(Y)  &amp;\approx \lambda^{\frac{1}{\nu}}-\frac{\nu-1}{2\nu}\quad  \text{and} \quad Var(Y) \approx \frac{1}{\nu}E(Y),
\end{aligned}
\]</span> and they can be particularly accurate for <span class="math inline">\(\nu\leq 1\)</span> or <span class="math inline">\(\lambda&gt;10^{\nu}\)</span> (see <span class="citation">Shmueli et al. (2005)</span>). If <span class="math inline">\(\nu &lt; 1\)</span>, CMP is overdispersed. In reverse, CMP is underdispersed when <span class="math inline">\(\nu&gt;1\)</span>.</p>
</div>
<div id="glm" class="section level2">
<h2 class="hasAnchor">
<a href="#glm" class="anchor"></a>Conway-Maxwell-Poisson Generalized Linear Models</h2>
<p>As CMP is one of a few distributions that can handle both under- and over-dispersion, the aim is to extend the GLM formulation to the CMP case so that one can model the relationship between <span class="math inline">\(Y\)</span> and the predictors <span class="math inline">\(X\)</span>. Given a set of covariates <span class="math inline">\(X \in R^q\)</span>, <span class="citation">Sellers and Shmueli (2010)</span> proposed a GLM for count response <span class="math inline">\(Y\)</span> that can be specified via <span class="math display">\[
Y|X ∼ CMP(\lambda,\nu), \quad \text{s.t.} \quad \log\lambda = X^{\top}\beta
\]</span> where <span class="math inline">\(\beta \in R^q\)</span> is a vector of regression coefficients. This model however does not provide a closed form relationship between <span class="math inline">\(E(Y)\)</span> and the linear predictor, making it incompatible with other commonly used log-linear model.</p>
<p>As it is more convenient and interpretable to model the mean <span class="math inline">\(\mu = E(Y)&gt;0\)</span> of the distribution directly, <span class="citation">Huang (2017)</span> proposed to parametrize the CMP distribution via the mean: <span class="math display">\[
P(Y = y|\mu, \nu) = \frac{\lambda(\mu,\nu)^{y}}{(y!)^{\nu}}\frac{1}{Z(\lambda(\mu,\nu),\nu)}, \quad y = 0,1,2,\ldots,
\]</span> where the rate <span class="math inline">\(\lambda(\mu,\nu)\)</span> is defined as the solution to the mean constraint: <span class="math display">\[
 \mu= \sum^{\infty}_{y=0} y\frac{\lambda^y}{(y!)^{\nu}}\frac{1}{Z(\lambda,\nu)}.
\]</span> We shall denote this as CMP<span class="math inline">\(_{\mu}(\mu, \nu)\)</span> distribution to distinguish it from the original/standard one.</p>
<p>A GLM that based on CMP<span class="math inline">\(_{\mu}\)</span> can then be specified via <span class="math display">\[
Y|X ∼ CMP_{\mu}(\mu(X^{\top}\beta),\nu), 
\]</span> where <span class="math display">\[
E(Y|X) = \mu(X^{\top}\beta) = \exp(X^{\top}\beta).
\]</span> Note that GLM that based on CMP<span class="math inline">\(_{\mu}\)</span> is a genuine GLM, so all the familiar key features of GLMs (e.g., McCullagh &amp; Nelder, 1989, Chapter 2) are retained.</p>
<p>The mean-dispersion specification makes CMP<span class="math inline">\(_{\mu}\)</span> directly comparable and compatible other commonly used log-linear regression models for counts. In particular, the mean <span class="math inline">\(\mu = \exp(X^{\top}\beta)\)</span> is functionally independent of the dispersion parameter <span class="math inline">\(\nu\)</span>, making it similar in structure to the familiar Negative Binomial regression model for overdispersed counts.</p>
<p>The model can also be extended so that <span class="math inline">\(\nu\)</span> itself is modelled via a regression with a log-link, i.e. <span class="math display">\[
\nu = \exp(\tilde{X}^{\top}\gamma),
\]</span> where <span class="math inline">\(\tilde{X}\)</span> is some covariates.</p>
</div>
<div id="the-mpcmp-package" class="section level2">
<h2 class="hasAnchor">
<a href="#the-mpcmp-package" class="anchor"></a>The <code>mpcmp</code> package</h2>
<p>The main modelling function in our <code>mpcmp</code> package is <code>glm.cmp</code>. Once a fitted model object has been obtained, there are assessor functions available to extract the coefficients (<code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code>, or its alias <code><a href="https://rdrr.io/r/stats/coef.html">coefficients()</a></code>), the fitted values (<code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code> or its alias <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted.values()</a></code>), the residuals (<code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> or its alias <code><a href="https://rdrr.io/r/stats/residuals.html">resid()</a></code>), the model frame (<code><a href="https://rdrr.io/r/stats/model.frame.html">model.frame()</a></code>), the number of observations (nobs()), the log-likelihood (<code><a href="https://rdrr.io/r/stats/logLik.html">logLik()</a></code>), and the AIC (<code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code>).</p>
<p>You can also use <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> or <code><a href="../reference/gg_plot.html">gg_plot()</a></code> to obtain diagnostic plots of the fitted model.</p>
<p>Let’s go through some examples to show you what our package can do!</p>
</div>
<div id="constant-dispersion-example-attendance" class="section level2">
<h2 class="hasAnchor">
<a href="#constant-dispersion-example-attendance" class="anchor"></a>Constant Dispersion Example: <code>attendance</code>
</h2>
<p>The <code>attendance</code> dataset (originally from <a href="https://stats.idre.ucla.edu/stat/stata/dae/nb_data.dta">https://stats.idre.ucla.edu/r/dae/negative-binomial-regression/</a>) examines the relationship between the number of days absent from school and the gender, maths score and academic program of 314 students from two urban high schools.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mpcmp</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">attendance</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">attendance</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">daysabs</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">prog</span>)) + <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw">binwidth</span> <span class="kw">=</span> <span class="fl">1</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span>(<span class="no">prog</span> ~ <span class="no">.</span>, <span class="kw">margins</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>)</pre></body></html></div>
<p><img src="mpcmp_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>It is obvious that there are some overdispersion in this dataset. We can use <code><a href="../reference/glm.cmp.html">glm.cmp()</a></code> to fit the mean-parametrized CMP model to this data set.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">M.attendance</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/glm.cmp.html">glm.cmp</a></span>(<span class="no">daysabs</span>~ <span class="no">gender</span>+<span class="no">math</span>+<span class="no">prog</span>, <span class="kw">data</span><span class="kw">=</span><span class="no">attendance</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">M.attendance</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: glm.cmp(formula = daysabs ~ gender + math + prog, data = attendance)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -2.1925  -1.1166  -0.3973   0.2964   2.8154  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Model Coefficients:</span>
<span class="co">#&gt;                Estimate Std.Err Z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)      2.7146  0.1904   14.26  &lt; 2e-16 ***</span>
<span class="co">#&gt; gendermale      -0.2147  0.1171   -1.83    0.067 .  </span>
<span class="co">#&gt; math            -0.0063  0.0024   -2.65    0.008 ** </span>
<span class="co">#&gt; progAcademic    -0.4253  0.1695   -2.51    0.012 *  </span>
<span class="co">#&gt; progVocational  -1.2539  0.1895   -6.62  3.7e-11 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for Mean-CMP estimated to be  0.02024 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 455.83  on 313 degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 377.44  on 309 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 1739.026</span></pre></body></html></div>
<p>As <code>mpcmp</code> is directly comparable and compatible with other commonly used log-linear regression models for counts, interpreting parameters is straight forward. Our model estimates that students in the General program (the reference level) are expected to miss exp(+1.254) = 3.5 times more days of school compared to students in the Vocational program.</p>
</div>
<div id="varying-dispersion-example-sitophilus" class="section level2">
<h2 class="hasAnchor">
<a href="#varying-dispersion-example-sitophilus" class="anchor"></a>Varying Dispersion Example: <code>sitophilus</code>
</h2>
<p>Ribeiro et al. (2013) carried out an experiment to assess the bioactivity of extracts from different parts (seeds, leaves and branches) of Annona mucosa (Annonaceae) to control Sitophilus zeamaus (Coleoptera: Curculionidae), a major pest of stored maize/corn in Brazil.</p>
<p>In this experiment:</p>
<ul>
<li>10g of corn and 20 animals adults were placed in each Petri dish.</li>
<li>Extracts prepared with different parts of mucosa or just water (control) were completely randomised with 10 replicates.</li>
<li>The numbers of emerged insects (progeny) after 60 days were recorded and some descriptive statistics can be found below.</li>
</ul>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">sitophilus</span>)
<span class="no">sitophilus</span> <span class="kw">%&gt;%</span> <span class="fu">group_by</span>(<span class="no">extract</span>) <span class="kw">%&gt;%</span>  <span class="fu">summarise</span>(<span class="kw">mu</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">ninsect</span>), <span class="kw">sigma2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span>(<span class="no">ninsect</span>))
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   extract    mu sigma2</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Control  31.5  62.5 </span>
<span class="co">#&gt; 2 Leaf     31.3  94.0 </span>
<span class="co">#&gt; 3 Branch   29.9  88.8 </span>
<span class="co">#&gt; 4 Seed      1.1   1.66</span></pre></body></html></div>
<p>It appears that the treatment may have some impact on both the mean and variance of the number of progeny. Recall that non-constant variance is a given in a GLM, non-constant variances do not necessarily means varying dispersion. Nonetheless, we will try to use the treatment to explain the dispersion in the data set.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">sitophilus</span>)
<span class="no">M.sit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/glm.cmp.html">glm.cmp</a></span>(<span class="kw">formula</span> <span class="kw">=</span> <span class="no">ninsect</span> ~ <span class="no">extract</span>, <span class="kw">formula_nu</span> <span class="kw">=</span> ~ <span class="no">extract</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">sitophilus</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">M.sit</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: glm.cmp(formula = ninsect ~ extract, formula_nu = ~extract, data = sitophilus)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span>
<span class="co">#&gt; -2.21084  -1.16849   0.07494   0.64152   1.72653  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mean Model Coefficients:</span>
<span class="co">#&gt;               Estimate Std.Err Z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     3.4500  0.0780   44.25   &lt;2e-16 ***</span>
<span class="co">#&gt; extractLeaf    -0.0064  0.1221   -0.05     0.96    </span>
<span class="co">#&gt; extractBranch  -0.0521  0.1234   -0.42     0.67    </span>
<span class="co">#&gt; extractSeed    -3.3547  0.3621   -9.26   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Dispersion Model Coefficients:</span>
<span class="co">#&gt;               Estimate Std.Err Z value Pr(&gt;|z|)</span>
<span class="co">#&gt; (Intercept)     -0.665   0.457   -1.45     0.15</span>
<span class="co">#&gt; extractLeaf     -0.383   0.651   -0.59     0.56</span>
<span class="co">#&gt; extractBranch   -0.372   0.651   -0.57     0.57</span>
<span class="co">#&gt; extractSeed     -0.118   1.546   -0.08     0.94</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 257.211  on 39 degrees of freedom</span>
<span class="co">#&gt; Residual deviance:  41.679  on 32 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 260.8279</span></pre></body></html></div>
<p>From the model summary, we can see that there is not much evidence to suggest the dispersions are varying across treatment groups. We can also formally test whether a constant dispersion model is sufficient here using a likelihood ratio test as the two models are nested:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">M.sit2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span>(<span class="no">M.sit</span>, <span class="kw">formula_nu</span> <span class="kw">=</span> <span class="kw">NULL</span>)
<span class="fu"><a href="../reference/cmplrtest.html">cmplrtest</a></span>(<span class="no">M.sit</span>, <span class="no">M.sit2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Likelihood ratio test for testing both COM-Poisson models are equivalent</span>
<span class="co">#&gt; LRT-statistic:  0.439 </span>
<span class="co">#&gt; Chi-sq degrees of freedom:  3 </span>
<span class="co">#&gt; P-value:  0.932</span></pre></body></html></div>
<p>As a result, our final model is</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">M.sit2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call: glm.cmp(formula = ninsect ~ extract, data = sitophilus)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -1.9515  -1.2310   0.0794   0.6255   1.6762  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Model Coefficients:</span>
<span class="co">#&gt;               Estimate Std.Err Z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept)     3.4500  0.0885   39.00   &lt;2e-16 ***</span>
<span class="co">#&gt; extractLeaf    -0.0064  0.1253   -0.05     0.96    </span>
<span class="co">#&gt; extractBranch  -0.0521  0.1267   -0.41     0.68    </span>
<span class="co">#&gt; extractSeed    -3.3547  0.3722   -9.01   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for Mean-CMP estimated to be  0.3957 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 234.470  on 39 degrees of freedom</span>
<span class="co">#&gt; Residual deviance:  41.408  on 36 degrees of freedom</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; AIC: 253.2668</span></pre></body></html></div>
</div>
<div id="diagnostics" class="section level2">
<h2 class="hasAnchor">
<a href="#diagnostics" class="anchor"></a>Diagnostics</h2>
<div id="likelihood-ratio-test" class="section level3">
<h3 class="hasAnchor">
<a href="#likelihood-ratio-test" class="anchor"></a>Likelihood ratio test</h3>
</div>
<div id="probability-integral-transformation" class="section level3">
<h3 class="hasAnchor">
<a href="#probability-integral-transformation" class="anchor"></a>Probability integral transformation</h3>
</div>
<div id="plots" class="section level3">
<h3 class="hasAnchor">
<a href="#plots" class="anchor"></a>Plots</h3>
</div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>There are three example datasets currently included in the <code>mpcmp</code> package which cover over- and under-dispersed counts. Sample analyses for these datsets are provided in either the help page for the datasets or for the <code><a href="../reference/glm.cmp.html">glm.cmp()</a></code> function.</p>
<div id="underdispersed-takeover-bids-data" class="section level3">
<h3 class="hasAnchor">
<a href="#underdispersed-takeover-bids-data" class="anchor"></a>Underdispersed takeover bids data</h3>
</div>
<div id="underdispersed-cotton-bolls-data" class="section level3">
<h3 class="hasAnchor">
<a href="#underdispersed-cotton-bolls-data" class="anchor"></a>Underdispersed Cotton bolls data</h3>
</div>
</div>
<div id="other-packages-for-fitting-conway-maxwell-poisson-model" class="section level2">
<h2 class="hasAnchor">
<a href="#other-packages-for-fitting-conway-maxwell-poisson-model" class="anchor"></a>Other packages for fitting Conway-Maxwell Poisson Model</h2>
<p>There are other <code>R</code> packages to deal with CMP models and they all help the writing and construction of this package.</p>
<ul>
<li>
<code>compoisson</code>: Routines for density and moments of the COM-Poisson distribution under original parametrization by <span class="citation">(<span class="citeproc-not-found" data-reference-id="R-compoisson"><strong>???</strong></span>)</span>
</li>
<li>
<code>CompGLM</code>: Fit COM-Poisson models under original parametrization (includes dispersion modeling) by <span class="citation">(<span class="citeproc-not-found" data-reference-id="R-CompGLM"><strong>???</strong></span>)</span>.</li>
<li>
<code>COMPoissonReg</code>: Fit COM-Poisson models under original parametrization (includes zero-inflation and dispersion modeling) by <span class="citation">(<span class="citeproc-not-found" data-reference-id="R-COMPoissonReg"><strong>???</strong></span>)</span>.</li>
<li>
<code>glmmTMB</code>: Fit (among other) COM-Poisson models under a different mean-parametrization (includes zero-inflation, dispersion modeling and random effects) by <span class="citation">(<span class="citeproc-not-found" data-reference-id="R-glmmTMB"><strong>???</strong></span>)</span>.</li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Huang2017b">
<p>Huang, Alan. 2017. “Mean-parametrized Conway–Maxwell–Poisson regression models for dispersed counts.” <em>Statistical Modelling</em> 17 (6): 359–80. <a href="https://doi.org/10.1177/1471082X17697749">https://doi.org/10.1177/1471082X17697749</a>.</p>
</div>
<div id="ref-Sellers2010">
<p>Sellers, Kimberly F., and Galit Shmueli. 2010. “A flexible regression model for count data.” <em>Annals of Applied Statistics</em> 4 (2): 943–61. <a href="https://doi.org/10.1214/09-AOAS306">https://doi.org/10.1214/09-AOAS306</a>.</p>
</div>
<div id="ref-Shmueli2005">
<p>Shmueli, G., T. P Minka, J. B Kadane, S. Borle, and P. Boatwright. 2005. “A useful distribution for fitting discrete data:revival of the conway-Maxwell_Poisson distribution.” <em>Applied Statistics</em> 54 (1): 127–42. <a href="https://doi.org/10.1111/j.1467-9876.2005.00474.x">https://doi.org/10.1111/j.1467-9876.2005.00474.x</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thomas Fung, Aya Alwan, Justin Wishart, Alan Huang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
